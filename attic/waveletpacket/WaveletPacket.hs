module WaveletPacket
(
  read_wp_coeff
, apply_wp
)
where

import Control.Monad as CM
import MotherWavelet

apply_wp :: Int->[Double]->[Double]->IO[[[Double]]]
apply_wp wp_order wp_coeff tsdata = do
  let ntsdata = length tsdata     
      maxlevel = floor (logBase 2 (fromIntegral (length tsdata)) - (logBase 2 (fromIntegral wp_order))) + 2
  let wp_tree_level = calc_wp_tree maxlevel wp_coeff [[tsdata]]
  return $ reverse wp_tree_level

calc_wp_tree :: Int->[Double]->[[[Double]]]->[[[Double]]]
calc_wp_tree nn wp_coeff (xs:[]) = calc_wp_tree nn wp_coeff $ [calc_tree_coeff wp_coeff xs] ++ [xs]
calc_wp_tree nn wp_coeff (xs:xss) 
  | ((nn-1)>(length xss)) = calc_wp_tree nn wp_coeff $ [calc_tree_coeff wp_coeff xs] ++ [xs] ++ xss
  | otherwise = [xs] ++ xss
  
calc_tree_coeff ::[Double]->[[Double]]->[[Double]]
calc_tree_coeff wp_coeff xs = do
  let norder = length wp_coeff
      wp_coeff_h = wp_coeff
      coefflist = take norder $ cycle [1,-1]
      wp_coeff_g = zipWith (*) coefflist $ reverse wp_coeff
      wp_result_h = map (calc_ghresult wp_coeff_h) xs
      wp_result_g = map (calc_ghresult wp_coeff_g) xs
  interleave wp_result_g wp_result_h

calc_ghresult :: [Double]->[Double]->[Double]
calc_ghresult wp_coeff xs = do
  let norder = length wp_coeff
      ndata = length xs
      xs' = xs ++ (take norder xs)
      indexform = [0,2..(length xs)]
  result_coef <- CM.forM indexform $ \index -> do
    let xscoef = drop index xs'
    return $ sum $ zipWith (*) wp_coeff xscoef
  init $ result_coef

interleave :: [[Double]]->[[Double]]->[[Double]]
interleave [] ys = ys
interleave (x:xs) ys = x : interleave ys xs

read_wp_coeff :: MOTHERWAVELET->Int->[Double]
read_wp_coeff motherw wp_order 
   | motherw == Daubechies = read_wp_coeff_daub wp_order
   | motherw == Symlet = read_wp_coeff_symlet wp_order
   | motherw == Meyer = read_wp_coeff_meyer wp_order
   | otherwise = []

read_wp_coeff_daub :: Int->[Double]
read_wp_coeff_daub wp_order
   | wp_order == 2 = [0.70710678118655,0.70710678118655]
   | wp_order == 4 = [0.48296291314469,0.83651630373747, 0.22414386804186,-0.12940952255092]
   | wp_order == 6 = [0.33267055295096,0.80689150931334,0.45987750211933,-0.13501102001039,-0.08544127388224,0.03522629188210]
   | wp_order == 8 = [0.23037781330886,0.71484657055254,0.63088076792959,-0.02798376941698,-0.18703481171888,0.03084138183599,0.03288301166698,-0.01059740178500]
   | wp_order == 10 = [0.16010239797413,0.60382926979747,0.72430852843857,0.13842814590110,-0.24229488706619,-0.03224486958503,0.07757149384007,-0.00624149021301,-0.01258075199902,0.00333572528500]
   | wp_order == 12 = [0.11154074335008,0.49462389039839,0.75113390802158,0.31525035170924,-0.22626469396517,-0.12976686756710,0.09750160558708,0.02752286553002,-0.03158203931803,0.00055384220099,0.00477725751101,-0.00107730108500]
   | wp_order == 14 = [0.07785205408506,0.39653931948231,0.72913209084656,0.46978228740536,-0.14390600392911,-0.22403618499417,0.07130921926705,0.08061260915107,-0.03802993693503,-0.01657454163102,0.01255099855601,0.00042957797300,-0.00180164070400,0.00035371380000]
   | wp_order == 16 = [0.05441584224308,0.31287159091447,0.67563073629801,0.58535468365487,-0.01582910525602,-0.28401554296243,0.00047248457400,0.12874742662019,-0.01736930100202,-0.04408825393106,0.01398102791702,0.00874609404702,-0.00487035299301,-0.00039174037300,0.00067544940600,-0.00011747678400]
   | wp_order == 18 = [0.03807794736317,0.24383467463767,0.60482312367678,0.65728807803664,0.13319738582209,-0.29327378327259,-0.09684078322088,0.14854074933476,0.03072568147832,-0.06763282905952,0.00025094711499,0.02236166212352,-0.00472320475789,-0.00428150368190,0.00184764688296,0.00023038576400,-0.00025196318900,0.00003934732000]
   | wp_order == 20 = [0.02667005790095,0.18817680007762,0.52720118893092,0.68845903945259,0.28117234366043,-0.24984642432649,-0.19594627437660,0.12736934033574,0.09305736460381,-0.07139414716586,-0.02945753682195,0.03321267405893,0.00360655356699,-0.01073317548298,0.00139535174699,0.00199240529499,-0.00068585669500,-0.00011646685499,0.00009358867000,-0.00001326420300]
   | wp_order == 22 = [0.01869429776147,0.14406702115062,0.44989976435603,0.68568677491617,0.41196436894790,-0.16227524502747,-0.27423084681793,0.06604358819669,0.14981201246638,-0.04647995511667,-0.06643878569502,0.03133509021905,0.02084090436018,-0.01536482090620,-0.00334085887301,0.00492841765606,-0.00030859285882,-0.00089302325067,0.00024915252355,0.00005443907470,-0.00003463498419,0.00000449427428]
   | wp_order == 24 = [0.01311225795723,0.10956627282118,0.37735513521419,0.65719872257928,0.51588647842779,-0.04476388565377,-0.31617845375276,-0.02377925725606,0.18247860592758,0.00535956967437,-0.09643212009649,0.01084913025583,0.04154627749509,-0.01221864906975,-0.01284082519830,0.00671149900880,0.00224860724100,-0.00217950361863,0.00000654512821,0.00038865306282,-0.00008850410921,-0.00002424154576,0.00001277695222,-0.00000152907176]
   | wp_order == 26 = [0.00920213353896,0.08286124387290,0.31199632216043,0.61105585115878,0.58888957043121,0.08698572617964,-0.31497290771138,-0.12457673075080,0.17947607942935,0.07294893365679,-0.10580761818792,-0.02648840647534,0.05613947710028,0.00237997225405,-0.02383142071033,0.00392394144879,0.00725558940162,-0.00276191123466,-0.00131567391189,0.00093232613087,0.00004925152513,-0.00016512898856,0.00003067853758,0.00001044193057,-0.00000470041648,0.00000052200351]
   | wp_order == 28 = [0.00646115346009,0.06236475884939,0.25485026779257,0.55430561794077,0.63118784910472,0.21867068775886,-0.27168855227868,-0.21803352999321,0.13839521386480,0.13998901658447,-0.08674841156811,-0.07154895550399,0.05523712625925,0.02698140830794,-0.03018535154036,-0.00561504953034,0.01278949326634,-0.00074621898927,-0.00384963886802,0.00106169108561,0.00070802115424,-0.00038683194731,-0.00004177724577,0.00006875504253,-0.00001033720918,-0.00000438970490,0.00000172499468,-0.00000017871400]
   | wp_order == 30 = [0.00453853736158,0.04674339489277,0.20602386398700,0.49263177170816,0.64581314035744,0.33900253545474,-0.19320413960915,-0.28888259656697,0.06528295284880,0.19014671400716,-0.03966617655576,-0.11112093603722,0.03387714392350,0.05478055058448,-0.02576700732848,-0.02081005016973,0.01508391802781,0.00510100036039,-0.00648773456032,-0.00024175649076,0.00194332398038,-0.00037348235414,-0.00035956524436,0.00015589648992,0.00002579269916,-0.00002813329627,0.00000336298718,0.00000181127041,-0.00000063168823,0.00000006133360]
   | wp_order == 32 = [0.00318922092535,0.03490771432367,0.16506428348885,0.43031272284599,0.63735633208377,0.44029025688634,-0.08975108940249,-0.32706331052792,-0.02791820813305,0.21119069394708,0.02734026375270,-0.13238830556381,-0.00623972275247,0.07592423604429,-0.00758897436884,-0.03688839769171,0.01029765964098,0.01399376885985,-0.00699001456340,-0.00364427962149,0.00312802338121,0.00040789698085,-0.00094102174936,0.00011424152004,0.00017478724523,-0.00006103596621,-0.00001394566899,0.00001133660866,-0.00000104357134,-0.00000073636568,0.00000023087841,-0.00000002109340]
   | wp_order == 34 = [0.00224180700104,0.02598539370361,0.13121490330784,0.37035072415269,0.61099661568471,0.51831576405701,0.02731497040330,-0.32832074836400,-0.12659975221589,0.19731058956506,0.10113548917751,-0.12681569177829,-0.05709141963170,0.08110598665412,0.02231233617804,-0.04692243838934,-0.00327095553587,0.02273367658392,-0.00304298998137,-0.00860292152033,0.00296799669153,0.00230120524216,-0.00143684530480,-0.00032813251941,0.00043946542777,-0.00002561010957,-0.00008204803202,0.00002318681380,0.00000699060099,-0.00000450594248,0.00000030165496,0.00000029577009,-0.00000008423948,0.00000000726749]
   | wp_order == 36 = [0.00157631021844,0.01928853172418,0.10358846582258,0.31467894133751,0.57182680776747,0.57180165488952,0.14722311197014,-0.29365404073704,-0.21648093400555,0.14953397556546,0.16708131276330,-0.09233188415126,-0.10675224666029,0.06488721621171,0.05705124773838,-0.04452614190323,-0.02373321039602,0.02667070592642,0.00626216795425,-0.01305148094667,0.00011863003383,0.00494334360546,-0.00111873266700,-0.00134059629834,0.00062846568297,0.00021358156191,-0.00019864855231,-0.00000015359171,0.00003741237881,-0.00000852060254,-0.00000333263448,0.00000176871298,-0.00000007691633,-0.00000011760988,0.00000003068836,-0.00000000250793]
   | wp_order == 38 = [0.00110866976318,0.01428109845070,0.08127811326510,0.26438843173972,0.52443637746232,0.60170454912487,0.26089495264991,-0.22809139421438,-0.28583863175437,0.07465226970810,0.21234974330584,-0.03351854190149,-0.14278569503735,0.02758435062625,0.08690675555608,-0.02650123624947,-0.04567422627659,0.02162376740985,0.01937554988940,-0.01398838867821,-0.00586692228080,0.00704074736719,0.00076895435932,-0.00268755180066,0.00034180865347,0.00073580252051,-0.00026067613568,-0.00012460079173,0.00008711270467,0.00000510595049,-0.00001664017630,0.00000301096432,0.00000153193148,-0.00000068627557,0.00000001447088,0.00000004636938,-0.00000001116402,0.00000000086668]
   | wp_order == 40 = [0.00077995361366,0.01054939462487,0.06342378045858,0.21994211354965,0.47269618530714,0.61049323893374,0.36150229873647,-0.13921208801035,-0.32678680043141,-0.01672708830897,0.22829105081798,0.03985024645728,-0.15545875070610,-0.02471682733811,0.10229171917456,0.00563224685888,-0.06172289962210,0.00587468181393,0.03229429953237,-0.00878932492251,-0.01381052613626,0.00672162730258,0.00442054238715,-0.00358149425955,-0.00083156217282,0.00139255961930,-0.00005349759845,-0.00038510474870,0.00010153288973,0.00006774280828,-0.00003710586183,-0.00000437614386,0.00000724124829,-0.00000101199401,-0.00000068470796,0.00000026339242,0.00000000020143,-0.00000001814843,0.00000000405613,-0.00000000029988]
   | wp_order == 42 = [0.00054882250986,0.00777663905246,0.04924777153883,0.18135962544278,0.41968794494492,0.60150609494296,0.44459045193348,-0.03572291961772,-0.33566408953492,-0.11239707156980,0.21156452768396,0.11523329844160,-0.13994042493413,-0.08177594298219,0.09660039032382,0.04572340574753,-0.06497750489781,-0.01865385920593,0.03972683542509,0.00335775638782,-0.02089205367997,0.00240347091984,0.00898882438159,-0.00289133434884,-0.00295837403905,0.00171660704064,0.00063941850053,-0.00069067111708,-0.00003196406277,0.00019366465042,-0.00003635520250,-0.00003499665985,0.00001535482509,0.00000279033054,-0.00000309001716,0.00000031660954,0.00000029921366,-0.00000010004009,-0.00000000225401,0.00000000705803,-0.00000000147195,0.00000000010388]
   | wp_order == 44 = [0.00038626323150,0.00572185463145,0.03806993723721,0.14836754089323,0.36772868345377,0.57843273102169,0.50790109063283,0.07372450118513,-0.31272658043501,-0.20056840610944,0.16409318810947,0.17997318799515,-0.09711079841387,-0.13176813769363,0.06807631438861,0.08455737636227,-0.05136425430463,-0.04653081183330,0.03697084661864,0.02058670762720,-0.02348000134426,-0.00621378284801,0.01256472522016,0.00030013739972,-0.00545569198552,0.00104426073960,0.00182701049587,-0.00077069098807,-0.00042378739982,0.00032860941423,0.00004345899905,-0.00009405223635,0.00001137434966,0.00001737375696,-0.00000616672932,-0.00000156517913,0.00000129518206,-0.00000008779880,-0.00000012833362,0.00000003761229,0.00000000168017,-0.00000000272962,0.00000000053359,-0.00000000003602]
   | wp_order == 46 = [0.00027190419416,0.00420274889370,0.02931000366146,0.12051553179868,0.31845081389173,0.54493114794003,0.55101851730917,0.18139262538597,-0.26139214806257,-0.27140209864102,0.09212540709353,0.22357365826899,-0.03303744709916,-0.16401132155390,0.02028307457378,0.11229704362359,-0.02112621237227,-0.07020739160254,0.02176585681370,0.03849533250212,-0.01852351367601,-0.01753710102460,0.01275194391902,0.00603184064178,-0.00707531927963,-0.00113486547603,0.00312287644907,-0.00024650140100,-0.00106123122919,0.00031942049269,0.00025676245202,-0.00015002185037,-0.00003378894835,0.00004426071204,-0.00000263520789,-0.00000834787557,0.00000239756955,0.00000081475748,-0.00000053390054,0.00000001853092,0.00000005417549,-0.00000001399935,-0.00000000094729,0.00000000105045,-0.00000000019324,0.00000000001250]
   | wp_order == 48 = [0.00019143580095,0.00308208171500,0.02248233995038,0.09726223583651,0.27290891607582,0.50437104085489,0.57493922111260,0.28098555324203,-0.18727140689076,-0.31794307900890,0.00477661368430,0.23923738878710,0.04252872964227,-0.17117535137613,-0.03877717358004,0.12101630347157,0.02098011370824,-0.08216165421234,-0.00457843624443,0.05130162003823,-0.00494470943241,-0.02821310710056,0.00766172187681,0.01304997086673,-0.00629143537412,-0.00474656878930,0.00373604617663,0.00115376493595,-0.00169645681942,-0.00004416184869,0.00058612705931,-0.00011812332380,-0.00014600798177,0.00006559388640,0.00002183241461,-0.00002022888293,0.00000001341158,0.00000390110034,-0.00000089802531,-0.00000040325078,0.00000021663397,-0.00000000050576,-0.00000002255740,0.00000000515778,0.00000000047484,-0.00000000040247,0.00000000006992,-0.00000000000434]
   | wp_order == 50 = [0.00013480297936,0.00225695959203,0.01718674125537,0.07803586287819,0.23169350790401,0.45968341518179,0.58163689679121,0.36788507483148,-0.09717464097229,-0.33647307966812,-0.08758761459496,0.22453781976164,0.11815528672764,-0.15056021376482,-0.09850861530222,0.10663380501832,0.06675216448493,-0.07708411108361,-0.03717396289023,0.05361790937603,0.01554260590837,-0.03404232047610,-0.00307983679799,0.01892280448261,-0.00198942577434,-0.00886070261061,0.00272693626530,0.00332270777835,-0.00184248428806,-0.00089997742272,0.00087725819420,0.00011532124422,-0.00030988009907,0.00003543714525,0.00007904640005,-0.00002733048120,-0.00001277195293,0.00000899066139,0.00000052328277,-0.00000177920133,0.00000032120375,0.00000019228068,-0.00000008656942,-0.00000000261160,0.00000000927922,-0.00000000188042,-0.00000000022285,0.00000000015359,-0.00000000002528,0.00000000000151]
   | wp_order == 52 = [0.00009493795747,0.00165052023287,0.01309755428729,0.06227474400009,0.19503943863827,0.41329296211202,0.57366904280335,0.43915831161244,0.00177407678034,-0.32638459356024,-0.17483996121861,0.18129183223897,0.18275540951738,-0.10432390024244,-0.14797719321441,0.06982318608594,0.10648240520785,-0.05344856165621,-0.06865475956471,0.04223218580538,0.03853571600107,-0.03137811028460,-0.01776090348004,0.02073492025806,0.00582958063302,-0.01178549783685,-0.00052873835369,0.00560194726473,-0.00093905823572,-0.00214553027435,0.00083834880766,0.00061613822092,-0.00043195570707,-0.00010605747474,0.00015747952381,-0.00000527779549,-0.00004109673995,0.00001074221541,0.00000700007868,-0.00000388740016,-0.00000046504632,0.00000079392106,-0.00000010790042,-0.00000008904466,0.00000003407796,0.00000000216933,-0.00000000377601,0.00000000067800,0.00000000010023,-0.00000000005840,0.00000000000913,-0.00000000000053]
   | wp_order == 54 = [0.00006687131379,0.00120553123053,0.00995258877145,0.04945259993605,0.16292202734804,0.36711021377760,0.55384986046579,0.49340612221061,0.10284085496457,-0.28971680303965,-0.24826458166690,0.11482301941169,0.22727328820471,-0.03878641858319,-0.17803174076834,0.01579939748221,0.13119797164867,-0.01406275146647,-0.09102290634917,0.01731101835678,0.05796940579574,-0.01851249342470,-0.03273906647991,0.01614696702403,0.01566559574354,-0.01157718635089,-0.00586209625930,0.00685663566511,0.00134262691970,-0.00333285443828,0.00014575297882,0.00130117745760,-0.00034183511836,-0.00038790185541,0.00020197198834,0.00007660058395,-0.00007711145508,-0.00000351748362,0.00002063442645,-0.00000390116407,-0.00000365750091,0.00000163436962,0.00000030508807,-0.00000034724681,0.00000003286559,0.00000004026255,-0.00000001321332,-0.00000000130947,0.00000000152161,-0.00000000024155,-0.00000000004375,0.00000000002214,-0.00000000000330,0.00000000000018]
   | wp_order == 56 = [0.00004710807766,0.00087949851431,0.00754265036328,0.03909260804095,0.13513791399624,0.32256336067113,0.52499823063037,0.53051629243100,0.20017614366470,-0.23049895360849,-0.30132780895814,0.03285787910353,0.24580815091531,0.03690688527328,-0.18287733031840,-0.04683823352168,0.13462756788564,0.03447863155804,-0.09768535516323,-0.01734192227806,0.06774789588669,0.00344801938223,-0.04333336823364,0.00443173305187,0.02468805998294,-0.00681554982076,-0.01206359205683,0.00583881650115,0.00478486300787,-0.00372546130632,-0.00136037388200,0.00187599864580,0.00014156723219,-0.00074867495568,0.00011546560683,0.00022957909867,-0.00008903901415,-0.00004907713377,0.00003641401216,0.00000463866501,-0.00001004326038,0.00000124790032,0.00000184036373,-0.00000066702155,-0.00000017574612,0.00000014906600,-0.00000000826239,-0.00000001784139,0.00000000504405,0.00000000069445,-0.00000000060770,0.00000000008492,0.00000000001867,-0.00000000000837,0.00000000000119,-0.00000000000006]
   | wp_order == 58 = [0.00003318966297,0.00064095168358,0.00570212654694,0.03077358037883,0.11137011752144,0.28065345740663,0.48975880726750,0.55137443557886,0.28910523981468,-0.15402873524802,-0.33004095060681,-0.05570680036129,0.23610523735052,0.11241917542149,-0.16087798947795,-0.10784595061226,0.11447229626215,0.08322074724110,-0.08512549355142,-0.05502749046173,0.06347916412676,0.03053154257401,-0.04518798236422,-0.01291714340149,0.02947043137455,0.00264832683582,-0.01704122498871,0.00173788013922,0.00846972541737,-0.00255080721472,-0.00347379905891,0.00187712089643,0.00108705391903,-0.00100077835149,-0.00020007114870,0.00041112834174,-0.00002292018316,-0.00012930448572,0.00003645026049,0.00002913344752,-0.00001657328408,-0.00000359364483,0.00000475060927,-0.00000030290546,-0.00000089757018,0.00000026338984,0.00000009387197,-0.00000006286157,0.00000000107659,0.00000000776898,-0.00000000189400,-0.00000000034268,0.00000000024071,-0.00000000002941,-0.00000000000783,0.00000000000315,-0.00000000000043,0.00000000000002]
   | wp_order == 60 = [0.00002338616182,0.00046663795235,0.00430079718272,0.02413083277074,0.09123830444189,0.24202067193463,0.45048782370427,0.55757223520372,0.36624268487617,-0.06618367104886,-0.33296697639194,-0.14196851392136,0.19946212238116,0.17782987393397,-0.11455821998655,-0.15723681875947,0.07277865900869,0.12274774614278,-0.05380646625820,-0.08765869114446,0.04380166398048,0.05671236507154,-0.03567339847522,-0.03226375971045,0.02707861927863,0.01528796063552,-0.01839974396002,-0.00529685959906,0.01091563182436,0.00061967186322,-0.00553073010417,0.00084338462127,0.00232452011131,-0.00086092770350,-0.00076787825930,0.00050509482141,0.00017248258226,-0.00021617183228,-0.00000854830600,0.00006982008384,-0.00001339716873,-0.00001636152487,0.00000725214556,0.00000232754911,-0.00000218726769,0.00000001099474,0.00000042616623,-0.00000010004147,-0.00000004764380,0.00000002605443,0.00000000055534,-0.00000000333111,0.00000000069849,0.00000000016136,-0.00000000009461,0.00000000001000,0.00000000000324,-0.00000000000119,0.00000000000015,-0.00000000000001]
   | otherwise = []

read_wp_coeff_symlet :: Int->[Double]
read_wp_coeff_symlet wp_order
   | wp_order == 4 = [0.48296291314469,0.83651630373747,0.22414386804186,-0.12940952255092]
   | wp_order == 6 = [0.33267055295096,0.80689150931334,0.45987750211933,-0.13501102001039,-0.08544127388224,0.03522629188210]
   | wp_order == 8 = [0.03222310060404,-0.01260396726204,-0.09921954357685,0.29785779560528,0.80373875180592,0.49761866763202,-0.02963552764600,-0.07576571478927]
   | wp_order == 10 = [0.01953888273529,-0.02110183402476,-0.17532808990845,0.01660210576452,0.63397896345821,0.72340769040242,0.19939753397739,-0.03913424930238,0.02951949092577,0.02733306834508]
   | wp_order == 12 = [-0.00780070832503,0.00176771186424,0.04472490177067,-0.02106029251230,-0.07263752278646,0.33792942172762,0.78764114103019,0.49105594192675,-0.04831174258563,-0.11799011114819,0.00349071208422,0.01540410932703]
   | wp_order == 14 = [0.01026817670851,0.00401024487153,-0.10780823770382,-0.14004724044296,0.28862963175151,0.76776431700316,0.53610191709176,0.01744125508686,-0.04955283493713,0.06789269350137,0.03051551316596,-0.01263630340325,-0.00104738488868,0.00268181456826]
   | wp_order == 16 = [0.00188995033276,-0.00030292051472,-0.01495225833705,0.00380875201389,0.04913717967361,-0.02721902991706,-0.05194583810771,0.36444189483533,0.77718575170052,0.48135965125837,-0.06127335906766,-0.14329423835081,0.00760748732492,0.03169508781149,-0.00054213233179,-0.00338241595101]
   | wp_order == 18 = [0.00106949003291,-0.00047315449868,-0.01026406402763,0.00885926749340,0.06207778930289,-0.01823377077940,-0.19155083129729,0.03527248803528,0.61733844914095,0.71789708276441,0.23876091460730,-0.05456895843084,0.00058346274613,0.03022487885828,-0.01152821020768,-0.01327196778182,0.00061978088899,0.00140091552591]
   | wp_order == 20 = [-0.00045932942100,0.00005703608362,0.00459317358531,-0.00080435893202,-0.02035493981231,0.00576491203358,0.04999497207738,-0.03199005688243,-0.03553674047382,0.38382676106708,0.76951003702110,0.47169066693844,-0.07088053578324,-0.15949427888492,0.01160989390371,0.04592723923109,-0.00146538258130,-0.00864129927702,0.00009563267072,0.00077015980911]
   | wp_order == 22 = [0.00048926361026,0.00011053509764,-0.00638960366645,-0.00200347190011,0.04300019068155,0.03526675956446,-0.14460234370532,-0.20465479449578,0.23768990904928,0.73034354908840,0.57202297801007,0.09719839445889,-0.02283265102257,0.06997679961073,0.03703741597886,-0.02408084159587,-0.00985793482879,0.00651249567477,0.00058835273540,-0.00173436626730,-0.00003879565574,0.00017172195070]
   | wp_order == 24 = [-0.00017906658698,-0.00001815807886,0.00235029761418,0.00030764779631,-0.01458983644923,-0.00260439103133,0.05780417944551,0.01530174062248,-0.17037069723887,-0.07833262231632,0.46274103121933,0.76347909778368,0.39888597239018,-0.02216230617039,-0.03584883073697,0.04917931829966,0.00755378061168,-0.02422072267502,-0.00140890924433,0.00741496551766,0.00018021409009,-0.00134975575557,-0.00001135392804,0.00011196719425]
   | wp_order == 26 = [0.00007042986691,0.00003690537342,-0.00072136438514,0.00041326119884,0.00567485376012,-0.00149244727426,-0.02074968632552,0.01761829688065,0.09292603089915,0.00881975767043,-0.14049009311369,0.11023022302128,0.64456438390117,0.69573915056158,0.19770481877127,-0.12436246075151,-0.05975062771796,0.01386249743584,-0.01721164272631,-0.02021676813340,0.00529635973872,0.00752622538997,-0.00017094285853,-0.00113606343893,-0.00003573862365,0.00006820325263]
   | wp_order == 28 = [0.00004461897799,0.00001932901697,-0.00060576018247,-0.00007321421357,0.00453267747195,0.00101314198718,-0.01943931426363,-0.00236504883674,0.06982761636183,0.02589858753105,-0.15999741114654,-0.05811182331763,0.47533576263445,0.75997624196128,0.39320152196202,-0.03531811211520,-0.05763449835147,0.03743308836280,0.00428052049898,-0.02919621776406,-0.00275377479123,0.01003769371768,0.00036647657366,-0.00257944172593,-0.00006286542481,0.00039843567298,0.00001121086581,-0.00002587909027]
   | wp_order == 30 = [0.00002866070853,0.00002171789015,-0.00040216853760,-0.00010815440169,0.00348102873707,0.00152613827819,-0.01717125278165,-0.00874478888650,0.06796982904489,0.06839331006054,-0.13405629845629,-0.19662635876643,0.24396270543204,0.72184302963632,0.57864041521527,0.11153369514269,-0.04108266663544,0.04073547969677,0.02193764271975,-0.03887671687685,-0.01940501143095,0.01007997708790,0.00342345073635,-0.00359016544737,-0.00026731644647,0.00107056721946,0.00005512254786,-0.00016066186637,-0.00000735966680,0.00000971241974]
   | wp_order == 32 = [-0.00001079798210,-0.00000539648318,0.00016545679579,0.00003656592483,-0.00133872060669,-0.00022211647621,0.00693776113081,0.00135984474247,-0.02495275804631,-0.00351027506830,0.07803785290360,0.03072113906330,-0.15959219218533,-0.05404060138707,0.47534280601285,0.75652498787649,0.39712293361998,-0.03457422841817,-0.06698304907080,0.03233309161055,0.00486927440478,-0.03105120284367,-0.00312651717226,0.01266673165989,0.00071821197882,-0.00388091225262,-0.00010844562231,0.00085235471081,0.00002807858213,-0.00010943147930,-0.00000311355641,0.00000623000670]
   | wp_order == 34 = [0.00000379125319,-0.00000245271634,-0.00007607124406,0.00002520793314,0.00071982706421,0.00005840042870,-0.00393232527979,-0.00190540768987,0.01239698836660,0.00995298252353,-0.01803889724182,-0.00726163475091,0.01615880872602,-0.08607087472032,-0.15507600534989,0.18053958457921,0.68148899534246,0.65071662920429,0.14239835041670,-0.11856693260976,0.01727117821070,0.10475461484209,0.01790395221460,-0.03329138349213,-0.00481921280320,0.01048236693298,0.00085677007020,-0.00274167597567,-0.00013864230268,0.00047599638026,-0.00001350638340,-0.00006293702598,0.00000278012669,0.00000429734333]
   | wp_order == 36 = [-0.00000151315307,0.00000078472981,0.00002955743762,-0.00000985881603,-0.00026583011024,0.00004741614518,0.00142808632708,-0.00018877623940,-0.00523978968302,0.00108778478960,0.01501235634429,-0.00326074419997,-0.03171268473169,0.00627794455441,0.02852959703912,-0.07379920729075,-0.03248057329092,0.40148386056943,0.75362914010133,0.47396905989475,-0.05202915898285,-0.15993814866901,0.03399566710369,0.08421992997028,-0.00507708516062,-0.03032509108928,0.00164298639727,0.00950216439096,-0.00041152110922,-0.00231387181450,0.00007021273459,0.00039616840638,-0.00001402099258,-0.00004524675787,0.00000135491576,0.00000261261256]
   | wp_order == 38 = [0.00000175093680,0.00000206231706,-0.00002815113866,-0.00001682138703,0.00027621877686,0.00012930767651,-0.00170496026116,-0.00061792232780,0.00826223695551,0.00431935187495,-0.02770989693110,-0.01690823486119,0.08407267627915,0.09363084341623,-0.11624173010592,-0.17659686625066,0.25826616923642,0.71955552571378,0.57814494533691,0.10902582508132,-0.06752505803991,0.00895459117312,0.00701557385747,-0.04663598353443,-0.02265199337798,0.01579743929571,0.00796843832065,-0.00512220500254,-0.00116070325720,0.00212142502817,0.00015915804768,-0.00063576451500,-0.00004612039600,0.00011553923334,0.00000887331217,-0.00001188051827,-0.00000064636513,0.00000054877328]
   | wp_order == 40 = [-0.00000063291290,-0.00000032567026,0.00001228725278,0.00000452542221,-0.00011739133516,-0.00002661555034,0.00074761085974,0.00012544091727,-0.00347164780267,-0.00061112638609,0.01215704094790,0.00193859706772,-0.03537333675507,-0.00684370196894,0.08891966801896,0.03625095165273,-0.16057829841234,-0.05108834294808,0.47199147504138,0.75116272838989,0.40583144438308,-0.02981936882107,-0.07899434489912,0.02557934951284,0.00812322835892,-0.03162943714139,-0.00331385738520,0.01700404902119,0.00142308736006,-0.00660658579824,-0.00030526283204,0.00208899470791,0.00007215991195,-0.00049473109149,-0.00001928412302,0.00007992967834,0.00000302566606,-0.00000791936141,-0.00000019015676,0.00000036955375]
   | wp_order == 42 = [0.00000023116904,-0.00000007401089,-0.00000516158836,0.00000183899845,0.00005820786308,-0.00001055398996,-0.00041349561806,-0.00002060745324,0.00203118441578,0.00069591568201,-0.00674898277369,-0.00409543219752,0.01450786941750,0.01118865626885,-0.01508147033057,0.00625464069426,0.02791728151204,-0.08709884432141,-0.15131078012891,0.19202706524796,0.68158332059527,0.64618599743615,0.14412386119274,-0.12356548353363,0.00736738941236,0.10148310770052,0.01067013591536,-0.04716326398300,-0.00899202924623,0.01540083464058,0.00176596179226,-0.00535395747976,-0.00043315590952,0.00142132044885,0.00006208657527,-0.00028647517579,0.00000607913038,0.00004694778085,-0.00000183116834,-0.00000509819139,0.00000007895915,0.00000024662467]
   | wp_order == 44 = [0.00000015701037,0.00000009966118,-0.00000328417896,-0.00000146277694,0.00003442102521,0.00001076285381,-0.00023615708448,-0.00004790058918,0.00120819750454,0.00021700733081,-0.00470892831539,-0.00077852943445,0.01485841354863,0.00255497233268,-0.03922962637142,-0.00752552739132,0.09413257032833,0.04132666895742,-0.15420831552203,-0.04123051452708,0.47683319799820,0.74899293929327,0.40287666044285,-0.03659053895049,-0.09061187088512,0.01915428943071,0.00842098867472,-0.03179026919182,-0.00355937471201,0.01864608663048,0.00168314925131,-0.00800078674386,-0.00046737262697,0.00282051712122,0.00011079462032,-0.00079412754687,-0.00003361349829,0.00016465262503,0.00000770422674,-0.00002357636865,-0.00000098649840,0.00000210708665,0.00000005624840,-0.00000008861606]
   | wp_order == 46 = [0.00000010235430,0.00000011947301,-0.00000207996803,-0.00000168882731,0.00002269111797,0.00001337545480,-0.00016515274988,-0.00006891398065,0.00092065028998,0.00035751068028,-0.00393795248714,-0.00159865021268,0.01387834485221,0.00751868829733,-0.03854919903172,-0.02759831960490,0.09194189389449,0.10791667041303,-0.11151590218887,-0.17895622157283,0.24859349726852,0.70931934236184,0.58652666181596,0.12546897118256,-0.07028820351936,-0.00454376049568,0.00255211302562,-0.04643623117797,-0.02186836373024,0.02077476122165,0.01143485977922,-0.00717111121596,-0.00281604932182,0.00304595670399,0.00045268316044,-0.00123284622195,-0.00009789651829,0.00036373350955,0.00002965227285,-0.00007386036564,-0.00000627559386,0.00001006623708,0.00000074523049,-0.00000084388462,-0.00000003876629,0.00000003321165]
   | wp_order == 48 = [-0.00000003763894,-0.00000001379902,0.00000092122723,0.00000035313033,-0.00001083968061,-0.00000471080885,0.00007954430272,0.00003554828409,-0.00041089637963,-0.00015315078955,0.00165852411624,0.00036533725724,-0.00578932461719,-0.00070874601122,0.01791452935815,0.00422746501837,-0.04281324592714,-0.01507710368464,0.08102456049784,0.02392107501492,-0.16088779689114,-0.02988259975726,0.48880974855408,0.74688385743468,0.39288115166264,-0.04379342297629,-0.08777599016841,0.03444149388902,0.02574605129641,-0.02426279125326,-0.00322429774344,0.01824651181612,0.00027829218166,-0.01009299895819,-0.00061288026541,0.00390135636880,0.00032248385033,-0.00117205334361,-0.00010277190304,0.00027429214178,0.00002161714042,-0.00004875059458,-0.00000276094813,0.00000635141112,0.00000020725965,-0.00000054069132,-0.00000000809775,0.00000002208787]
   | wp_order == 50 = [0.00000001417393,-0.00000000128584,-0.00000035883307,0.00000008450483,0.00000460200134,-0.00000106655594,-0.00003862052166,0.00000525387369,0.00023387577301,0.00000581099069,-0.00106357085882,-0.00024665256419,0.00363827754098,0.00168360713385,-0.00899375078539,-0.00591958921067,0.01498023419939,0.00993789458552,-0.01340322915072,0.01798969208769,0.03862447178667,-0.08574203560471,-0.14658183869341,0.20129994479568,0.68175692878985,0.64245780610168,0.14440656141754,-0.12888353966089,-0.00288020261395,0.09620356820102,0.00454479703964,-0.05697322565402,-0.01086875280482,0.02115133223651,0.00336812528826,-0.00801783983806,-0.00080537486804,0.00276454631473,0.00021102111165,-0.00074974673235,-0.00002424720226,0.00016847624768,-0.00000317175456,-0.00003152810174,0.00000107502980,0.00000434483509,-0.00000008618136,-0.00000036987182,0.00000000130255,0.00000001435812]
   | wp_order == 52 = [-0.00000000543571,0.00000000199024,0.00000014430002,-0.00000005275976,-0.00000183707240,0.00000073688296,0.00001516517917,-0.00000654194941,-0.00009206773058,0.00003757555029,0.00043268934169,-0.00014414125172,-0.00160482533375,0.00038470529620,0.00477959384708,-0.00058695506598,-0.01115011462549,0.00028029270803,0.01851220018216,-0.00454082260968,-0.02417683712649,0.02788593725265,0.03357868590107,-0.08973261009127,-0.04066610256625,0.39654996642049,0.74534691300998,0.48659675911554,-0.03054816636870,-0.16263026270583,0.02381623987822,0.08335972926050,-0.01571336409339,-0.04542223587036,0.00529771387456,0.02060700942608,-0.00097581041791,-0.00728998611856,0.00040607789503,0.00226218548420,-0.00019898334754,-0.00062562025657,0.00005915042437,0.00014332547319,-0.00001083563455,-0.00002507873243,0.00000124228948,0.00000309673285,-0.00000008854202,-0.00000024216780,0.00000000335850,0.00000000917271]
   | wp_order == 54 = [0.00000000200486,-0.00000000225655,-0.00000005780336,0.00000005816294,0.00000081043393,-0.00000067142671,-0.00000724188402,0.00000454696437,0.00004551014829,-0.00001987214817,-0.00020932941145,0.00006267580812,0.00071471422728,-0.00020855313323,-0.00183995581592,0.00103837743414,0.00396141302209,-0.00484585447809,-0.00946085230775,0.01431280731090,0.02593596176648,-0.01789276436445,-0.04191593809368,0.00091947692675,-0.01754596460237,-0.07886544762866,0.13063831337891,0.58946164295955,0.70449404469039,0.24869269195981,-0.17335255579376,-0.10550196328364,0.11576172687488,0.09374636823657,-0.03849177869134,-0.04783974419199,0.01091220407678,0.01925636749894,-0.00314457482910,-0.00679065270580,0.00076187111254,0.00197699552151,-0.00018852424968,-0.00048322234864,0.00004468020830,0.00009726406937,-0.00000899977529,-0.00001546107195,0.00000144610528,0.00000186359765,-0.00000015046913,-0.00000015232407,0.00000000686339,0.00000000609786]
   | wp_order == 56 = [-0.00000000223841,-0.00000000080814,0.00000006348994,0.00000002240654,-0.00000087514214,-0.00000032744949,0.00000772104424,0.00000313803239,-0.00004848031767,-0.00002021976593,0.00023114897537,0.00008673264856,-0.00088921450226,-0.00024089432929,0.00295035213651,0.00045574888521,-0.00885635272453,-0.00132060610611,0.02310526980043,0.00629724042357,-0.04771096755582,-0.01621457161075,0.08536229609472,0.02357730093902,-0.16437040480472,-0.03154320812556,0.48424408416030,0.74397532266483,0.40014593426660,-0.03744630472127,-0.09120194632275,0.03285695485769,0.02986054897631,-0.02404713054345,-0.00585973849229,0.01865510958775,0.00038509113319,-0.01202490038160,-0.00054004768399,0.00563725023110,0.00043338521493,-0.00208037206914,-0.00018786535509,0.00062860489607,0.00005764318298,-0.00015428555363,-0.00001257590187,0.00003035437524,0.00000189746857,-0.00000466642977,-0.00000019675201,0.00000052609490,0.00000001351981,-0.00000003830230,-0.00000000048383,0.00000000134012]
   | wp_order == 58 = [0.00000000086914,0.00000000007683,-0.00000002476128,0.00000000304434,0.00000035944572,-0.00000006997480,-0.00000343511732,0.00000067174032,0.00002415810963,-0.00000310632315,-0.00013140817964,0.00000160162253,0.00056818760343,0.00008532968392,-0.00195185738910,-0.00065489520898,0.00527183982333,0.00284145407341,-0.01048311108995,-0.00699646454543,0.01478801128217,0.00757358653480,-0.01212866901975,0.02896370174289,0.04899578905306,-0.08385363336444,-0.14426113167429,0.20571029834063,0.68048314526649,0.64077273046963,0.14693981020727,-0.13193541112313,-0.01228374764213,0.08980937772282,-0.00093576808478,-0.06412063880974,-0.01161867252201,0.02656533167184,0.00487002331131,-0.01083258821344,-0.00136198949647,0.00428940824406,0.00040722859294,-0.00143251730877,-0.00009078820672,0.00040339823174,0.00000745768225,-0.00009793537610,0.00000196559708,0.00002001819326,-0.00000066704682,-0.00000321133820,0.00000007745993,0.00000036644309,-0.00000000281205,-0.00000002591084,-0.00000000007491,0.00000000084744]
   | wp_order == 60 = [0.00000000055439,0.00000000025363,-0.00000001650488,-0.00000000612778,0.00000024412962,0.00000008995017,-0.00000232354978,-0.00000089828469,0.00001589700483,0.00000647382806,-0.00008272690614,-0.00003293176436,0.00034385221446,0.00011735869759,-0.00119692134911,-0.00027628415438,0.00371380699054,0.00054379852399,-0.01038876691564,-0.00162932203336,0.02556854601492,0.00760939671239,-0.04889669601845,-0.01523693636380,0.08910160894494,0.02619852893355,-0.16204680547674,-0.02843781124261,0.48469802756342,0.74269377583417,0.40072254149852,-0.03849152799019,-0.09630227409198,0.02927099877092,0.02965858799887,-0.02521794463036,-0.00795200551976,0.01829724962657,0.00037212410631,-0.01284118848030,-0.00051919347319,0.00645416697646,0.00046642596970,-0.00258964861453,-0.00023156691354,0.00086145323605,0.00008209441595,-0.00023724380919,-0.00002120204181,0.00005384704875,0.00000402586750,-0.00000989667625,-0.00000055432800,0.00000142300528,0.00000005465707,-0.00000014986092,-0.00000000380480,0.00000001014810,0.00000000014934,-0.00000000032641]
   | otherwise = []
   
read_wp_coeff_meyer :: Int->[Double]
read_wp_coeff_meyer wp_order
   | wp_order == 62 = [0.0000000000000000e+00,-1.0099999569414229e-12, 8.5194596367962140e-09,-1.1119449525952780e-08,-1.0798819539621958e-08, 6.0669757413511352e-08,-1.0866516536735883e-07, 8.2006806503864813e-08, 1.1783004497663934e-07,-5.5063405652522782e-07, 1.1307947017916706e-06,-1.4895492164971559e-06, 7.3675728859037460e-07, 3.2054419133447798e-06,-1.6312699734552807e-05, 6.5543059305751491e-05,-6.0115023435160925e-04,-2.7046721246437250e-03, 2.2025341009110021e-03, 6.0458140973233040e-03,-6.3877183184971563e-03,-1.1061496392513451e-02, 1.5270015130934803e-02, 1.7423434103729693e-02,-3.2130793990211758e-02,-2.4348745906078023e-02, 6.3739024322801596e-02,3.0655091960824263e-02,-1.3284520043622938e-01,-3.5087555656258346e-02,4.4459300275757724e-01, 7.4458559231880628e-01, 4.4459300275757724e-01,-3.5087555656258346e-02,-1.3284520043622938e-01, 3.0655091960824263e-02,6.3739024322801596e-02,-2.4348745906078023e-02,-3.2130793990211758e-02,1.7423434103729693e-02, 1.5270015130934803e-02,-1.1061496392513451e-02,-6.3877183184971563e-03, 6.0458140973233040e-03, 2.2025341009110021e-03,-2.7046721246437250e-03,-6.0115023435160925e-04, 6.5543059305751491e-05,-1.6312699734552807e-05, 3.2054419133447798e-06, 7.3675728859037460e-07,-1.4895492164971559e-06, 1.1307947017916706e-06,-5.5063405652522782e-07,1.1783004497663934e-07, 8.2006806503864813e-08,-1.0866516536735883e-07,6.0669757413511352e-08,-1.0798819539621958e-08,-1.1119449525952780e-08,8.5194596367962140e-09,-1.0099999569414229e-12]
   | otherwise = []
